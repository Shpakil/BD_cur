{% extends 'base.html' %}

{% block content %}
<div class="d-flex justify-content-between align-items-center mb-4">
    <h2 class="text-danger">üîß –ü–∞–Ω–µ–ª—å –¢–µ—Ö–Ω–∏–∫–∞</h2>
    <div>
        <a href="{% url 'export_scooters_csv' %}" class="btn btn-sm btn-outline-success">–í—ã–≥—Ä—É–∑–∏—Ç—å CSV</a>
        <a href="{% url 'export_scooters_json' %}" class="btn btn-sm btn-outline-primary" target="_blank">–í—ã–≥—Ä—É–∑–∏—Ç—å JSON</a>
    </div>
</div>

{% if assigned_station %}
    <div class="alert alert-info">–í—ã –∑–∞–∫—Ä–µ–ø–ª–µ–Ω—ã –∑–∞ —Å—Ç–∞–Ω—Ü–∏–µ–π: <strong>{{ assigned_station.name }}</strong></div>
{% endif %}

<div class="table-responsive">
    <table class="table table-hover align-middle shadow-sm bg-white">
        <thead class="table-dark">
            <tr>
                <th>SN</th>
                <th>–ú–æ–¥–µ–ª—å</th>
                <th>–ó–∞—Ä—è–¥</th> <th>–°—Ç–∞—Ç—É—Å</th>
                <th>–î–µ–π—Å—Ç–≤–∏–µ</th>
            </tr>
        </thead>
        <tbody>
            {% for scooter in scooters %}
            <tr>
                <td class="fw-bold">{{ scooter.serial_number }}</td>
                <td>{{ scooter.model.name }}</td>

                <td>
                    <div class="d-flex align-items-center">
                        <span class="me-2">{{ scooter.battery.capacity }}%</span>
                        {% if scooter.battery.capacity < 10 %}
                            <span class="badge bg-danger animate-pulse">–ù–£–ñ–ù–ê –ó–ê–†–Ø–î–ö–ê</span>
                        {% endif %}
                    </div>
                </td>

                <td>
                    {% if scooter.status == 'broken' %}
                        <span class="badge bg-danger">–°–ª–æ–º–∞–Ω</span>
                    {% elif scooter.status == 'maintenance' %}
                        <span class="badge bg-warning text-dark">–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</span>
                    {% else %}
                        <span class="badge bg-success">–î–æ—Å—Ç—É–ø–µ–Ω</span>
                    {% endif %}
                </td>
                <td>
                    <form action="{% url 'change_status' scooter.id %}" method="post" class="d-flex">
                        {% csrf_token %}
                        <select name="status" class="form-select form-select-sm me-2">
                            <option value="available" {% if scooter.status == 'available' %}selected{% endif %}>–î–æ—Å—Ç—É–ø–µ–Ω</option>
                            <option value="maintenance" {% if scooter.status == 'maintenance' %}selected{% endif %}>–û–±—Å–ª—É–∂–∏–≤–∞–Ω–∏–µ</option>
                            <option value="broken" {% if scooter.status == 'broken' %}selected{% endif %}>–°–ª–æ–º–∞–Ω</option>
                        </select>
                        <button type="submit" class="btn btn-sm btn-dark">–û–∫</button>
                    </form>
                </td>
            </tr>
            {% endfor %}
        </tbody>
    </table>
</div>
{% endblock %}